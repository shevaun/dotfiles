# git aliases

alias ga='git add '
alias gaa="git add -A"
alias gb='git switch -c '
alias gca='git commit -a '
alias gco='git checkout'
alias gl="git smart-log"
alias gm='git merge '
alias gp="git push"
alias gs="git status"
alias gbk="git buildkite"

function gc() {
  git commit -m "$*"
}

function gup() {
  log=$(git -c color.diff=always pull)
  echo $log
  if echo $log | grep -q Gemfile.lock; then
    echo "Gemfile.lock changed, running bundle install"
    bundle install
  fi
  if echo $log | grep -q db/; then
    echo "db changed, running rails db:migrate"
    rails db:prepare db:seed
  fi
  if echo $log | grep -q yarn.lock; then
    echo "yarn.lock changed, running yarn"
    yarn
    pushd frontend > /dev/null
    yarn
    popd > /dev/null
  fi
  if echo $log | grep -q frontend/vendor/emojis; then
    echo "emojis updated, running git submodule update"
    git submodule update --init
  fi
}
